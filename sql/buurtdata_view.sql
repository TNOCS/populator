create or replace view cbs.buurtdata as
select
	gid,
	bu_naam,
	bu_code,
	wk_naam,
	gm_naam,
	postcode,
	cast(aant_inw as int),
	cast(p_00_14_jr as int),
	cast(case when aant_inw = -99999999 or aant_inw = 0 or p_00_14_jr = -99999999 or p_00_14_jr = 0 then 0 else round(aant_inw / 100 * p_00_14_jr) end as int) as t_00_14_jr,
	cast(p_15_24_jr as int),
	cast(case when aant_inw = -99999999 or aant_inw = 0 or p_15_24_jr = -99999999 or p_15_24_jr = 0 then 0 else round(aant_inw / 100 * p_15_24_jr) end as int) as t_15_24_jr,
	cast(p_25_44_jr as int),
	cast(case when aant_inw = -99999999 or aant_inw = 0 or p_25_44_jr = -99999999 or p_25_44_jr = 0 then 0 else round(aant_inw / 100 * p_25_44_jr) end as int) as t_25_44_jr,
	cast(p_45_64_jr as int),
	cast(case when aant_inw = -99999999 or aant_inw = 0 or p_45_64_jr = -99999999 or p_45_64_jr = 0 then 0 else round(aant_inw / 100 * p_45_64_jr) end as int) as t_45_64_jr,
	cast(p_65_eo_jr as int),
	cast(case when aant_inw = -99999999 or aant_inw = 0 or p_65_eo_jr = -99999999 or p_65_eo_jr = 0 then 0 else round(aant_inw / 100 * p_65_eo_jr) end as int) as t_65_eo_jr,
	cast(aantal_hh as int),
	cast(p_eenp_hh as int),
	cast(case when aantal_hh = -99999999 or aantal_hh = 0 or p_eenp_hh = -99999999 or p_eenp_hh = 0 then 0 else round(aantal_hh / 100 * p_eenp_hh) end as int) as t_eenp_hh,
	cast(p_hh_z_k as int),
	cast(case when aantal_hh = -99999999 or aantal_hh = 0 or p_hh_z_k = -99999999 or p_hh_z_k = 0 then 0 else round(aantal_hh / 100 * p_hh_z_k) end as int) as t_hh_z_k,
	cast(p_hh_m_k as int),
	cast(case when aantal_hh = -99999999 or aantal_hh = 0 or p_hh_m_k = -99999999 or p_hh_m_k = 0 then 0 else round(aantal_hh / 100 * p_hh_m_k) end as int) as t_hh_m_k,
	round(gem_hh_gr, 1) as gem_hh_gr,
	cast(p_west_al as int),
	cast(p_n_w_al as int),
	cast(p_marokko as int),
	cast(p_ant_aru as int),
	cast(p_surinam as int),
	cast(p_turkije as int),
	cast(p_over_nw as int),
	geovlak
from cbs.buurten